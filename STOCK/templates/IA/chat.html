{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
    <h2>ðŸ¤– Chatbot IA</h2>
    <div id="chatbox" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px;"></div>
    <input type="text" id="message" class="form-control mt-2" placeholder="Pose ta question...">
    <button onclick="envoyerMessage()" class="btn btn-primary mt-2">Envoyer</button>
</div>

<script>
function envoyerMessage() {
    const message = document.getElementById("message").value;
    fetch("{% url 'chatbot_api' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: "message=" + encodeURIComponent(message)
    })
    .then(response => response.json())
    .then(data => {
        let chatbox = document.getElementById("chatbox");
        chatbox.innerHTML += `<p><strong>Vous:</strong> ${message}</p>`;
        chatbox.innerHTML += `<p><strong>Bot:</strong> ${data.reponse}</p>`;
        document.getElementById("message").value = "";
        chatbox.scrollTop = chatbox.scrollHeight;
    });
}
</script>
{% endblock %}
