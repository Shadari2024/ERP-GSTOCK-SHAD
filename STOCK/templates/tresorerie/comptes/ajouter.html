{% extends 'base.html' %}

{% block content %}
<div class="container mt-4">
    <div class="card">
        <div class="card-header bg-primary text-white">
            <h4 class="mb-0">
                <i class="fas fa-plus-circle"></i> Ajouter un nouveau compte
            </h4>
        </div>
        <div class="card-body">
            <form method="post" class="needs-validation" novalidate>
                {% csrf_token %}
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="nom" class="form-label">Nom du compte *</label>
                        <input type="text" class="form-control" id="nom" name="nom" required>
                        <div class="invalid-feedback">
                            Veuillez saisir un nom pour le compte.
                        </div>
                    </div>
                    
                    <div class="col-md-6">
                        <label for="type_compte" class="form-label">Type de compte *</label>
                        <select class="form-select" id="type_compte" name="type_compte" required>
                            <option value="" selected disabled>Sélectionnez un type</option>
                            <option value="ESP">Espèces</option>
                            <option value="MM">Mobile Money</option>
                            <option value="BQ">Compte bancaire</option>
                            <option value="CR">Crédit</option>
                        </select>
                        <div class="invalid-feedback">
                            Veuillez sélectionner un type de compte.
                        </div>
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="solde_initial" class="form-label">Solde initial</label>
                        <div class="input-group">
                            <span class="input-group-text">{{ request.user.parametre.devise|default:"FCFA" }}</span>
                            <input type="number" class="form-control" id="solde_initial" name="solde_initial" step="0.01" value="0">
                        </div>
                        <small class="text-muted">Laissez 0 si le compte est nouveau</small>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between mt-4">
                    <a href="{% url 'liste_comptes' %}" class="btn btn-secondary">
                        <i class="fas fa-arrow-left"></i> Retour
                    </a>
                    <button type="submit" class="btn btn-success">
                        <i class="fas fa-save"></i> Enregistrer
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
// Validation Bootstrap
(function () {
  'use strict'
  
  // Fetch all the forms we want to apply custom Bootstrap validation styles to
  var forms = document.querySelectorAll('.needs-validation')
  
  // Loop over them and prevent submission
  Array.prototype.slice.call(forms)
    .forEach(function (form) {
      form.addEventListener('submit', function (event) {
        if (!form.checkValidity()) {
          event.preventDefault()
          event.stopPropagation()
        }
        
        form.classList.add('was-validated')
      }, false)
    })
})()
</script>

<style>
.card {
    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}
.card-header {
    font-weight: 600;
}
.form-label {
    font-weight: 500;
}
.invalid-feedback {
    display: none;
    width: 100%;
    margin-top: 0.25rem;
    font-size: 0.875em;
    color: #dc3545;
}
.was-validated .form-control:invalid ~ .invalid-feedback,
.was-validated .form-control:invalid ~ .invalid-feedback {
    display: block;
}
</style>
{% endblock %}